<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mythiq Ultimate</title>
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif; padding: 18px; max-width: 900px; margin: 0 auto; }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    textarea { width:100%; padding:10px; font-size:14px; }
    button { padding:10px 12px; font-weight:700; }
    pre { background:#0b1020; color:#d9e1ff; padding:12px; border-radius:10px; overflow:auto; }
    .muted { color:#444; font-size:12px; }
    .card { border:1px solid #ddd; border-radius:12px; padding:12px; margin-top:12px; }
    code { background:#f3f3f3; padding:2px 6px; border-radius:6px; }
  </style>
</head>
<body>
  <h2 style="margin:0 0 8px 0;">Mythiq Ultimate</h2>
  <div class="muted">UI server proxies to API. Useful links: <a href="/library">/library</a></div>

  <div class="card">
    <div class="row">
      <button id="btnStatus" type="button">Status</button>
      <button id="btnWarmup" type="button">Warmup</button>
      <button id="btnMetrics" type="button">Metrics</button>
    </div>
    <pre id="sysOut">{}</pre>
  </div>

  <div class="card">
    <div style="font-weight:700;margin-bottom:8px;">Chat</div>
    <textarea id="prompt" rows="5">Reply with exactly: ok</textarea>
    <div class="row" style="margin-top:10px;">
      <label class="muted">temp <input id="temp" type="number" step="0.1" value="0" style="width:80px;"></label>
      <label class="muted">max_tokens <input id="max" type="number" step="1" value="64" style="width:90px;"></label>
      <button id="btnSend" type="button">Send</button>
    </div>
    <pre id="out">{}</pre>
  </div>

<script>
  const $ = (id) => document.getElementById(id);
  function show(id, obj) { $(id).textContent = JSON.stringify(obj, null, 2); }

  async function jfetch(url, opts) {
    const r = await fetch(url, opts);
    const t = await r.text();
    try { return JSON.parse(t); } catch { return { ok:false, error:"non-json", raw:t, status:r.status }; }
  }

  $("btnStatus").onclick = async () => show("sysOut", await jfetch("/status"));
  $("btnWarmup").onclick = async () => show("sysOut", await jfetch("/warmup", { method:"POST" }));
  $("btnMetrics").onclick = async () => show("sysOut", await jfetch("/metrics?n=20"));

  $("btnSend").onclick = async () => {
    const payload = {
      prompt: $("prompt").value,
      temperature: Number($("temp").value || 0),
      max_tokens: Number($("max").value || 64),
    };
    show("out", await jfetch("/chat", {
      method:"POST",
      headers:{ "content-type":"application/json" },
      body: JSON.stringify(payload),
    }));
  };
</script>
</body>
</html>
